{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useThemeScroller = exports[\"default\"] = void 0;\nvar _handle = require(\"@enact/core/handle\");\nvar _keymap = require(\"@enact/core/keymap\");\nvar _platform = _interopRequireDefault(require(\"@enact/core/platform\"));\nvar _spotlight = _interopRequireDefault(require(\"@enact/spotlight\"));\nvar _utils = require(\"@enact/spotlight/src/utils\");\nvar _resolution = _interopRequireDefault(require(\"@enact/ui/resolution\"));\nvar _utilDOM = _interopRequireDefault(require(\"@enact/ui/useScroll/utilDOM\"));\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\nvar _react = require(\"react\");\nvar _useScroll = require(\"../useScroll\");\nvar _useEvent = require(\"./useEvent\");\nvar _ScrollerModule = _interopRequireDefault(require(\"./Scroller.module.css\"));\nvar _ScrollbarTrackModule = _interopRequireDefault(require(\"../useScroll/ScrollbarTrack.module.css\"));\nvar _excluded = [\"className\", \"children\", \"editable\", \"fadeOut\", \"scrollContainerRef\"],\n  _excluded2 = [\"setNavigableFilter\"];\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      _defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPropertyKey(t) {\n  var i = _toPrimitive(t, \"string\");\n  return \"symbol\" == typeof i ? i : String(i);\n}\nfunction _toPrimitive(t, r) {\n  if (\"object\" != typeof t || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != typeof i) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nvar isCancel = (0, _keymap.is)('cancel'),\n  isEnter = (0, _keymap.is)('enter'),\n  isBody = function isBody(elem) {\n    return elem.classList.contains(_ScrollerModule[\"default\"].focusableBody);\n  };\nvar getFocusableBodyProps = function getFocusableBodyProps(scrollContainerRef, contentId, isScrollbarVisible) {\n  var spotlightId = scrollContainerRef.current && scrollContainerRef.current.dataset.spotlightId;\n  var consumeKeyUpTarget = null;\n  var setNavigableFilter = function setNavigableFilter(_ref) {\n    var filterTarget = _ref.filterTarget;\n    spotlightId = scrollContainerRef.current && scrollContainerRef.current.dataset.spotlightId;\n    if (spotlightId && filterTarget) {\n      var targetClassName = filterTarget === 'body' ? _ScrollerModule[\"default\"].focusableBody : _ScrollbarTrackModule[\"default\"].thumb;\n      _spotlight[\"default\"].set(spotlightId, {\n        navigableFilter: function navigableFilter(elem) {\n          return typeof elem === 'string' || !elem.classList.contains(targetClassName);\n        }\n      });\n      return true;\n    }\n    return false;\n  };\n  var getNavigableFilterTarget = function getNavigableFilterTarget(ev) {\n    var keyCode = ev.keyCode,\n      target = ev.target,\n      type = ev.type;\n    var filterTarget = null;\n    if (!isScrollbarVisible) {\n      return {\n        filterTarget: filterTarget\n      };\n    }\n    if (type === 'focus') {\n      filterTarget = isBody(target) ? 'thumb' : 'body';\n    } else if (type === 'blur') {\n      filterTarget = 'body';\n    } else if (type === 'keydown') {\n      filterTarget = !_spotlight[\"default\"].getPointerMode() && isEnter(keyCode) && isBody(target) && 'body' || isEnter(keyCode) && !isBody(target) && 'thumb' || isCancel(keyCode) && !isBody(target) && 'thumb' || null;\n    }\n    return {\n      filterTarget: filterTarget\n    };\n  };\n  var consumeEventKeyDownWithFocus = function consumeEventKeyDownWithFocus(ev) {\n    var keyCode = ev.keyCode,\n      target = ev.target;\n    var nextTarget;\n    if (isBody(target)) {\n      // Enter key on scroll Body.\n      // Scroll thumb get focus.\n      var spottableDescendants = _spotlight[\"default\"].getSpottableDescendants(spotlightId);\n      if (spottableDescendants.length > 0) {\n        // Last spottable descendant(thumb) get focus.\n        nextTarget = spottableDescendants.pop();\n\n        // If there are both thumbs, vertical thumb is the next target\n        var verticalThumb = spottableDescendants.pop();\n        nextTarget = verticalThumb && verticalThumb.classList.contains(_ScrollbarTrackModule[\"default\"].thumb) ? verticalThumb : nextTarget;\n      }\n    } else {\n      // Enter or Cancel key on scroll thumb.\n      // Scroll body get focus.\n      nextTarget = target.closest(\".\".concat(_ScrollerModule[\"default\"].focusableBody));\n      consumeKeyUpTarget = isCancel(keyCode) && nextTarget || null;\n    }\n    if (nextTarget) {\n      _spotlight[\"default\"].focus(nextTarget);\n      ev.preventDefault();\n      ev.nativeEvent.stopImmediatePropagation();\n    }\n  };\n  var consumeEventKeyUp = function consumeEventKeyUp(ev) {\n    var keyCode = ev.keyCode,\n      target = ev.target;\n    if (isCancel(keyCode) && target === consumeKeyUpTarget) {\n      ev.nativeEvent.stopImmediatePropagation();\n    }\n    consumeKeyUpTarget = null;\n  };\n  return {\n    'aria-labelledby': contentId,\n    className: _ScrollerModule[\"default\"].focusableBody,\n    onFocus: (0, _handle.handle)((0, _handle.forward)('onFocus'), (0, _handle.adaptEvent)(getNavigableFilterTarget, setNavigableFilter)),\n    onBlur: (0, _handle.handle)(\n    // Focus out to external element.\n    (0, _handle.forward)('onBlur'), (0, _handle.adaptEvent)(getNavigableFilterTarget, setNavigableFilter)),\n    onKeyDown: (0, _handle.handle)((0, _handle.forward)('onKeyDown'), (0, _handle.adaptEvent)(getNavigableFilterTarget, setNavigableFilter), consumeEventKeyDownWithFocus),\n    onKeyUp: (0, _handle.handle)(consumeEventKeyUp),\n    setNavigableFilter: setNavigableFilter\n  };\n};\nvar useSpottable = function useSpottable(props, instances) {\n  var scrollContainerRef = instances.scrollContainerRef,\n    scrollContentHandle = instances.scrollContentHandle,\n    scrollContentRef = instances.scrollContentRef;\n\n  // Hooks\n\n  var _useEventKey = (0, _useEvent.useEventKey)(),\n    addGlobalKeyDownEventListener = _useEventKey.addGlobalKeyDownEventListener,\n    removeGlobalKeyDownEventListener = _useEventKey.removeGlobalKeyDownEventListener;\n  var setContainerDisabled = (0, _react.useCallback)(function (bool) {\n    if (scrollContainerRef.current) {\n      scrollContainerRef.current.dataset.spotlightContainerDisabled = bool;\n      if (bool) {\n        addGlobalKeyDownEventListener(function () {\n          setContainerDisabled(false);\n        });\n      } else {\n        removeGlobalKeyDownEventListener();\n      }\n    }\n  }, [addGlobalKeyDownEventListener, removeGlobalKeyDownEventListener, scrollContainerRef]);\n  (0, _react.useEffect)(function () {\n    return function () {\n      return setContainerDisabled(false);\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  (0, _react.useEffect)(function () {\n    var onUpdate = props.onUpdate;\n    if (onUpdate) {\n      onUpdate();\n    }\n  });\n\n  // Functions\n\n  /**\n   * Returns the first spotlight container between `node` and the scroller\n   *\n   * @param {Node} node A DOM node\n   *\n   * @returns {Node|Null} Spotlight container for `node`\n   * @private\n   */\n  function getSpotlightContainerForNode(node) {\n    do {\n      if (node.dataset.spotlightId && node.dataset.spotlightContainer && !node.dataset.expandableContainer) {\n        return node;\n      }\n    } while ((node = node.parentNode) && node !== scrollContentRef.current);\n  }\n\n  /**\n   * Calculates the \"focus bounds\" of a node. If the node is within a spotlight container, that\n   * container is scrolled into view rather than just the element.\n   *\n   * @param {Node} node Focused node\n   *\n   * @returns {Object} Bounds as returned by `getBoundingClientRect`\n   * @private\n   */\n  function getFocusedItemBounds(node) {\n    node = getSpotlightContainerForNode(node) || node;\n    return node.getBoundingClientRect();\n  }\n\n  /**\n   * Calculates the new `scrollTop`.\n   *\n   * @param {Node} item Focused item node\n   *\n   * @returns {Number} Calculated `scrollTop`\n   * @private\n   */\n  function calculateScrollTop(item) {\n    var threshold = _resolution[\"default\"].scale(48);\n    var roundToStart = function roundToStart(sb, st) {\n      // round to start\n      if (st < threshold) return 0;\n      return st;\n    };\n    var roundToEnd = function roundToEnd(sb, st, sh) {\n      // round to end\n      if (sh - (st + sb.height) < threshold) return sh - sb.height;\n      return st + _resolution[\"default\"].scale(_useScroll.affordanceSize);\n    };\n    // adding threshold into these determinations ensures that items that are within that are\n    // near the bounds of the scroller cause the edge to be scrolled into view even when the\n    // item itself is in view (e.g. due to margins)\n    var isItemBeforeView = function isItemBeforeView(ib, sb, d) {\n      return ib.top + d - threshold < sb.top;\n    };\n    var isItemAfterView = function isItemAfterView(ib, sb, d) {\n      return ib.top + d + ib.height + threshold > sb.top + sb.height;\n    };\n    var canItemFit = function canItemFit(ib, sb) {\n      return ib.height <= sb.height;\n    };\n    var calcItemAtStart = function calcItemAtStart(ib, sb, st, d) {\n      return ib.top + st + d - sb.top;\n    };\n    var calcItemAtEnd = function calcItemAtEnd(ib, sb, st, d) {\n      return ib.top + ib.height + st + d - (sb.top + sb.height);\n    };\n    var calcItemInView = function calcItemInView(ib, sb, st, sh, d) {\n      if (isItemBeforeView(ib, sb, d)) {\n        return roundToStart(sb, calcItemAtStart(ib, sb, st, d));\n      } else if (isItemAfterView(ib, sb, d)) {\n        return roundToEnd(sb, calcItemAtEnd(ib, sb, st, d), sh);\n      }\n      return st;\n    };\n    var container = getSpotlightContainerForNode(item);\n    var scrollerBounds = scrollContentRef.current.getBoundingClientRect();\n    var _scrollContentRef$cur = scrollContentRef.current,\n      scrollHeight = _scrollContentRef$cur.scrollHeight,\n      scrollTop = _scrollContentRef$cur.scrollTop;\n    var scrollTopDelta = 0;\n    var adjustScrollTop = function adjustScrollTop(v) {\n      scrollTopDelta = scrollTop - v;\n      scrollTop = v;\n    };\n    if (container) {\n      var containerBounds = container.getBoundingClientRect();\n\n      // if the entire container fits in the scroller, scroll it into view\n      if (canItemFit(containerBounds, scrollerBounds)) {\n        return calcItemInView(containerBounds, scrollerBounds, scrollTop, scrollHeight, scrollTopDelta);\n      }\n\n      // if the container doesn't fit, adjust the scroll top ...\n      if (containerBounds.top > scrollerBounds.top) {\n        // ... to the top of the container if the top is below the top of the scroller\n        adjustScrollTop(calcItemAtStart(containerBounds, scrollerBounds, scrollTop, scrollTopDelta));\n      }\n      // removing support for \"snap to bottom\" for 2.2.8\n      // } else if (containerBounds.top + containerBounds.height < scrollerBounds.top + scrollerBounds.height) {\n      // \t// ... to the bottom of the container if the bottom is above the bottom of the\n      // \t// scroller\n      // \tadjustScrollTop(calcItemAtEnd(containerBounds, scrollerBounds, scrollTop, scrollTopDelta));\n      // }\n\n      // N.B. if the container covers the scrollable area (its top is above the top of the\n      // scroller and its bottom is below the bottom of the scroller), we need not adjust the\n      // scroller to ensure the container is wholly in view.\n    }\n\n    var itemBounds = item.getBoundingClientRect();\n    return calcItemInView(itemBounds, scrollerBounds, scrollTop, scrollHeight, scrollTopDelta);\n  }\n\n  /**\n   * Calculates the new `scrollLeft`.\n   *\n   * @param {Node} item node\n   * @param {Number} scrollPosition last target position, passed when scroll animation is ongoing\n   *\n   * @returns {Number} Calculated `scrollLeft`\n   * @private\n   */\n  function calculateScrollLeft(item, scrollPosition) {\n    var scrollContentNode = scrollContentRef.current;\n    var _getFocusedItemBounds = getFocusedItemBounds(item),\n      itemLeft = _getFocusedItemBounds.left,\n      itemWidth = _getFocusedItemBounds.width;\n    var rtl = props.rtl,\n      coordinateCoefficient = rtl && !(_platform[\"default\"].chrome < 85) ? -1 : 1,\n      clientWidth = scrollContentHandle.current.scrollBounds.clientWidth,\n      rtlDirection = rtl ? -1 : 1,\n      _scrollContentNode$ge = scrollContentNode.getBoundingClientRect(),\n      containerLeft = _scrollContentNode$ge.left,\n      scrollLastPosition = scrollPosition ? scrollPosition : scrollContentHandle.current.scrollPos.left,\n      currentScrollLeft = rtl && coordinateCoefficient === 1 ? scrollContentHandle.current.scrollBounds.maxLeft - scrollLastPosition : scrollLastPosition,\n      newItemLeft = coordinateCoefficient * scrollContentNode.scrollLeft + (itemLeft - containerLeft);\n    var nextScrollLeft = scrollContentHandle.current.scrollPos.left;\n    if (newItemLeft + itemWidth > clientWidth + currentScrollLeft && itemWidth < clientWidth) {\n      // If focus is moved to an element outside of view area (to the right), scroller will move\n      // to the right just enough to show the current `focusedItem`. This does not apply to\n      // `focusedItem` that has a width that is bigger than `scrollBounds.clientWidth`.\n      nextScrollLeft += rtlDirection * (newItemLeft + itemWidth - (clientWidth + currentScrollLeft));\n    } else if (newItemLeft < currentScrollLeft) {\n      // If focus is outside of the view area to the left, move scroller to the left accordingly.\n      nextScrollLeft += rtlDirection * (newItemLeft - currentScrollLeft);\n    }\n    return nextScrollLeft;\n  }\n\n  /**\n   * Calculates the new top and left position for scroller based on focusedItem.\n   *\n   * @param {Node} item node\n   * @param {Number} scrollPosition last target position, passed scroll animation is ongoing\n   *\n   * @returns {Object} with keys {top, left} containing calculated top and left positions for scroll.\n   * @private\n   */\n  function calculatePositionOnFocus(_ref2) {\n    var item = _ref2.item,\n      scrollPosition = _ref2.scrollPosition;\n    var containerNode = scrollContentRef.current;\n    var horizontal = scrollContentHandle.current.isHorizontal();\n    var vertical = scrollContentHandle.current.isVertical();\n    if (!vertical && !horizontal || !item || !_utilDOM[\"default\"].containsDangerously(containerNode, item)) {\n      return;\n    }\n    var containerRect = (0, _utils.getRect)(containerNode);\n    var itemRect = (0, _utils.getRect)(item);\n    if (horizontal && !(itemRect.left >= containerRect.left + _resolution[\"default\"].scale(_useScroll.affordanceSize) && itemRect.right <= containerRect.right - _resolution[\"default\"].scale(_useScroll.affordanceSize))) {\n      scrollContentHandle.current.scrollPos.left = calculateScrollLeft(item, scrollPosition);\n    }\n    if (vertical && !(itemRect.top >= containerRect.top && itemRect.bottom <= containerRect.bottom - _resolution[\"default\"].scale(_useScroll.affordanceSize))) {\n      scrollContentHandle.current.scrollPos.top = calculateScrollTop(item);\n    }\n    return scrollContentHandle.current.scrollPos;\n  }\n  function focusOnNode(node) {\n    if (node) {\n      _spotlight[\"default\"].focus(node);\n    }\n  }\n\n  // Return\n\n  return {\n    calculatePositionOnFocus: calculatePositionOnFocus,\n    focusOnNode: focusOnNode,\n    setContainerDisabled: setContainerDisabled\n  };\n};\nvar useThemeScroller = exports.useThemeScroller = function useThemeScroller(props, scrollContentProps, contentId, isHorizontalScrollbarVisible, isVerticalScrollbarVisible) {\n  var className = scrollContentProps.className,\n    children = scrollContentProps.children,\n    editable = scrollContentProps.editable,\n    fadeOut = scrollContentProps.fadeOut,\n    scrollContainerRef = scrollContentProps.scrollContainerRef,\n    rest = _objectWithoutProperties(scrollContentProps, _excluded);\n  var scrollContainerHandle = rest.scrollContainerHandle,\n    scrollContentHandle = rest.scrollContentHandle,\n    scrollContentRef = rest.scrollContentRef;\n  delete rest.onUpdate;\n  delete rest.scrollContainerContainsDangerously;\n  delete rest.scrollContainerHandle;\n  delete rest.scrollContentHandle;\n  delete rest.setThemeScrollContentHandle;\n  delete rest.spotlightId;\n\n  // Hooks\n  var isScrollbarVisible = isHorizontalScrollbarVisible || isVerticalScrollbarVisible;\n  var _useSpottable = useSpottable(scrollContentProps, {\n      scrollContainerRef: scrollContainerRef,\n      scrollContentHandle: scrollContentHandle,\n      scrollContentRef: scrollContentRef\n    }),\n    calculatePositionOnFocus = _useSpottable.calculatePositionOnFocus,\n    focusOnNode = _useSpottable.focusOnNode,\n    setContainerDisabled = _useSpottable.setContainerDisabled;\n  var _ref3 = props.focusableScrollbar === 'byEnter' ? getFocusableBodyProps(scrollContainerRef, contentId, isScrollbarVisible) : {},\n    setNavigableFilter = _ref3.setNavigableFilter,\n    focusableBodyProps = _objectWithoutProperties(_ref3, _excluded2);\n  (0, _react.useLayoutEffect)(function () {\n    // Initial filter setting\n    if (setNavigableFilter) {\n      setNavigableFilter({\n        filterTarget: 'body'\n      });\n    }\n  }, [props.focusableScrollbar, scrollContainerRef.current]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  scrollContentProps.setThemeScrollContentHandle({\n    calculatePositionOnFocus: calculatePositionOnFocus,\n    focusOnNode: focusOnNode,\n    setContainerDisabled: setContainerDisabled\n  });\n\n  // Render\n\n  rest.className = (0, _classnames[\"default\"])(className, !isHorizontalScrollbarVisible && isVerticalScrollbarVisible && fadeOut ? _ScrollerModule[\"default\"].verticalFadeout : null, isHorizontalScrollbarVisible && !isVerticalScrollbarVisible && fadeOut ? _ScrollerModule[\"default\"].horizontalFadeout : null);\n  return {\n    editableWrapperProps: {\n      children: children,\n      editable: editable,\n      scrollContainerHandle: scrollContainerHandle,\n      scrollContainerRef: scrollContainerRef,\n      scrollContentRef: scrollContentRef\n    },\n    focusableBodyProps: focusableBodyProps,\n    themeScrollContentProps: _objectSpread({}, rest)\n  };\n};\nvar _default = exports[\"default\"] = useThemeScroller;","map":{"version":3,"names":["Object","defineProperty","exports","value","useThemeScroller","_handle","require","_keymap","_platform","_interopRequireDefault","_spotlight","_utils","_resolution","_utilDOM","_classnames","_react","_useScroll","_useEvent","_ScrollerModule","_ScrollbarTrackModule","_excluded","_excluded2","obj","__esModule","ownKeys","e","r","t","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","key","_toPropertyKey","configurable","writable","i","_toPrimitive","String","Symbol","toPrimitive","call","TypeError","Number","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","prototype","propertyIsEnumerable","sourceKeys","isCancel","is","isEnter","isBody","elem","classList","contains","focusableBody","getFocusableBodyProps","scrollContainerRef","contentId","isScrollbarVisible","spotlightId","current","dataset","consumeKeyUpTarget","setNavigableFilter","_ref","filterTarget","targetClassName","thumb","set","navigableFilter","getNavigableFilterTarget","ev","keyCode","type","getPointerMode","consumeEventKeyDownWithFocus","nextTarget","spottableDescendants","getSpottableDescendants","pop","verticalThumb","closest","concat","focus","preventDefault","nativeEvent","stopImmediatePropagation","consumeEventKeyUp","className","onFocus","handle","forward","adaptEvent","onBlur","onKeyDown","onKeyUp","useSpottable","props","instances","scrollContentHandle","scrollContentRef","_useEventKey","useEventKey","addGlobalKeyDownEventListener","removeGlobalKeyDownEventListener","setContainerDisabled","useCallback","bool","spotlightContainerDisabled","useEffect","onUpdate","getSpotlightContainerForNode","node","spotlightContainer","expandableContainer","parentNode","getFocusedItemBounds","getBoundingClientRect","calculateScrollTop","item","threshold","scale","roundToStart","sb","st","roundToEnd","sh","height","affordanceSize","isItemBeforeView","ib","d","top","isItemAfterView","canItemFit","calcItemAtStart","calcItemAtEnd","calcItemInView","container","scrollerBounds","_scrollContentRef$cur","scrollHeight","scrollTop","scrollTopDelta","adjustScrollTop","v","containerBounds","itemBounds","calculateScrollLeft","scrollPosition","scrollContentNode","_getFocusedItemBounds","itemLeft","left","itemWidth","width","rtl","coordinateCoefficient","chrome","clientWidth","scrollBounds","rtlDirection","_scrollContentNode$ge","containerLeft","scrollLastPosition","scrollPos","currentScrollLeft","maxLeft","newItemLeft","scrollLeft","nextScrollLeft","calculatePositionOnFocus","_ref2","containerNode","horizontal","isHorizontal","vertical","isVertical","containsDangerously","containerRect","getRect","itemRect","right","bottom","focusOnNode","scrollContentProps","isHorizontalScrollbarVisible","isVerticalScrollbarVisible","children","editable","fadeOut","rest","scrollContainerHandle","scrollContainerContainsDangerously","setThemeScrollContentHandle","_useSpottable","_ref3","focusableScrollbar","focusableBodyProps","useLayoutEffect","verticalFadeout","horizontalFadeout","editableWrapperProps","themeScrollContentProps","_default"],"sources":["/home/connected/enact-template/node_modules/@enact/sandstone/Scroller/useThemeScroller.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useThemeScroller = exports[\"default\"] = void 0;\nvar _handle = require(\"@enact/core/handle\");\nvar _keymap = require(\"@enact/core/keymap\");\nvar _platform = _interopRequireDefault(require(\"@enact/core/platform\"));\nvar _spotlight = _interopRequireDefault(require(\"@enact/spotlight\"));\nvar _utils = require(\"@enact/spotlight/src/utils\");\nvar _resolution = _interopRequireDefault(require(\"@enact/ui/resolution\"));\nvar _utilDOM = _interopRequireDefault(require(\"@enact/ui/useScroll/utilDOM\"));\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\nvar _react = require(\"react\");\nvar _useScroll = require(\"../useScroll\");\nvar _useEvent = require(\"./useEvent\");\nvar _ScrollerModule = _interopRequireDefault(require(\"./Scroller.module.css\"));\nvar _ScrollbarTrackModule = _interopRequireDefault(require(\"../useScroll/ScrollbarTrack.module.css\"));\nvar _excluded = [\"className\", \"children\", \"editable\", \"fadeOut\", \"scrollContainerRef\"],\n  _excluded2 = [\"setNavigableFilter\"];\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nvar isCancel = (0, _keymap.is)('cancel'),\n  isEnter = (0, _keymap.is)('enter'),\n  isBody = function isBody(elem) {\n    return elem.classList.contains(_ScrollerModule[\"default\"].focusableBody);\n  };\nvar getFocusableBodyProps = function getFocusableBodyProps(scrollContainerRef, contentId, isScrollbarVisible) {\n  var spotlightId = scrollContainerRef.current && scrollContainerRef.current.dataset.spotlightId;\n  var consumeKeyUpTarget = null;\n  var setNavigableFilter = function setNavigableFilter(_ref) {\n    var filterTarget = _ref.filterTarget;\n    spotlightId = scrollContainerRef.current && scrollContainerRef.current.dataset.spotlightId;\n    if (spotlightId && filterTarget) {\n      var targetClassName = filterTarget === 'body' ? _ScrollerModule[\"default\"].focusableBody : _ScrollbarTrackModule[\"default\"].thumb;\n      _spotlight[\"default\"].set(spotlightId, {\n        navigableFilter: function navigableFilter(elem) {\n          return typeof elem === 'string' || !elem.classList.contains(targetClassName);\n        }\n      });\n      return true;\n    }\n    return false;\n  };\n  var getNavigableFilterTarget = function getNavigableFilterTarget(ev) {\n    var keyCode = ev.keyCode,\n      target = ev.target,\n      type = ev.type;\n    var filterTarget = null;\n    if (!isScrollbarVisible) {\n      return {\n        filterTarget: filterTarget\n      };\n    }\n    if (type === 'focus') {\n      filterTarget = isBody(target) ? 'thumb' : 'body';\n    } else if (type === 'blur') {\n      filterTarget = 'body';\n    } else if (type === 'keydown') {\n      filterTarget = !_spotlight[\"default\"].getPointerMode() && isEnter(keyCode) && isBody(target) && 'body' || isEnter(keyCode) && !isBody(target) && 'thumb' || isCancel(keyCode) && !isBody(target) && 'thumb' || null;\n    }\n    return {\n      filterTarget: filterTarget\n    };\n  };\n  var consumeEventKeyDownWithFocus = function consumeEventKeyDownWithFocus(ev) {\n    var keyCode = ev.keyCode,\n      target = ev.target;\n    var nextTarget;\n    if (isBody(target)) {\n      // Enter key on scroll Body.\n      // Scroll thumb get focus.\n      var spottableDescendants = _spotlight[\"default\"].getSpottableDescendants(spotlightId);\n      if (spottableDescendants.length > 0) {\n        // Last spottable descendant(thumb) get focus.\n        nextTarget = spottableDescendants.pop();\n\n        // If there are both thumbs, vertical thumb is the next target\n        var verticalThumb = spottableDescendants.pop();\n        nextTarget = verticalThumb && verticalThumb.classList.contains(_ScrollbarTrackModule[\"default\"].thumb) ? verticalThumb : nextTarget;\n      }\n    } else {\n      // Enter or Cancel key on scroll thumb.\n      // Scroll body get focus.\n      nextTarget = target.closest(\".\".concat(_ScrollerModule[\"default\"].focusableBody));\n      consumeKeyUpTarget = isCancel(keyCode) && nextTarget || null;\n    }\n    if (nextTarget) {\n      _spotlight[\"default\"].focus(nextTarget);\n      ev.preventDefault();\n      ev.nativeEvent.stopImmediatePropagation();\n    }\n  };\n  var consumeEventKeyUp = function consumeEventKeyUp(ev) {\n    var keyCode = ev.keyCode,\n      target = ev.target;\n    if (isCancel(keyCode) && target === consumeKeyUpTarget) {\n      ev.nativeEvent.stopImmediatePropagation();\n    }\n    consumeKeyUpTarget = null;\n  };\n  return {\n    'aria-labelledby': contentId,\n    className: _ScrollerModule[\"default\"].focusableBody,\n    onFocus: (0, _handle.handle)((0, _handle.forward)('onFocus'), (0, _handle.adaptEvent)(getNavigableFilterTarget, setNavigableFilter)),\n    onBlur: (0, _handle.handle)(\n    // Focus out to external element.\n    (0, _handle.forward)('onBlur'), (0, _handle.adaptEvent)(getNavigableFilterTarget, setNavigableFilter)),\n    onKeyDown: (0, _handle.handle)((0, _handle.forward)('onKeyDown'), (0, _handle.adaptEvent)(getNavigableFilterTarget, setNavigableFilter), consumeEventKeyDownWithFocus),\n    onKeyUp: (0, _handle.handle)(consumeEventKeyUp),\n    setNavigableFilter: setNavigableFilter\n  };\n};\nvar useSpottable = function useSpottable(props, instances) {\n  var scrollContainerRef = instances.scrollContainerRef,\n    scrollContentHandle = instances.scrollContentHandle,\n    scrollContentRef = instances.scrollContentRef;\n\n  // Hooks\n\n  var _useEventKey = (0, _useEvent.useEventKey)(),\n    addGlobalKeyDownEventListener = _useEventKey.addGlobalKeyDownEventListener,\n    removeGlobalKeyDownEventListener = _useEventKey.removeGlobalKeyDownEventListener;\n  var setContainerDisabled = (0, _react.useCallback)(function (bool) {\n    if (scrollContainerRef.current) {\n      scrollContainerRef.current.dataset.spotlightContainerDisabled = bool;\n      if (bool) {\n        addGlobalKeyDownEventListener(function () {\n          setContainerDisabled(false);\n        });\n      } else {\n        removeGlobalKeyDownEventListener();\n      }\n    }\n  }, [addGlobalKeyDownEventListener, removeGlobalKeyDownEventListener, scrollContainerRef]);\n  (0, _react.useEffect)(function () {\n    return function () {\n      return setContainerDisabled(false);\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  (0, _react.useEffect)(function () {\n    var onUpdate = props.onUpdate;\n    if (onUpdate) {\n      onUpdate();\n    }\n  });\n\n  // Functions\n\n  /**\n   * Returns the first spotlight container between `node` and the scroller\n   *\n   * @param {Node} node A DOM node\n   *\n   * @returns {Node|Null} Spotlight container for `node`\n   * @private\n   */\n  function getSpotlightContainerForNode(node) {\n    do {\n      if (node.dataset.spotlightId && node.dataset.spotlightContainer && !node.dataset.expandableContainer) {\n        return node;\n      }\n    } while ((node = node.parentNode) && node !== scrollContentRef.current);\n  }\n\n  /**\n   * Calculates the \"focus bounds\" of a node. If the node is within a spotlight container, that\n   * container is scrolled into view rather than just the element.\n   *\n   * @param {Node} node Focused node\n   *\n   * @returns {Object} Bounds as returned by `getBoundingClientRect`\n   * @private\n   */\n  function getFocusedItemBounds(node) {\n    node = getSpotlightContainerForNode(node) || node;\n    return node.getBoundingClientRect();\n  }\n\n  /**\n   * Calculates the new `scrollTop`.\n   *\n   * @param {Node} item Focused item node\n   *\n   * @returns {Number} Calculated `scrollTop`\n   * @private\n   */\n  function calculateScrollTop(item) {\n    var threshold = _resolution[\"default\"].scale(48);\n    var roundToStart = function roundToStart(sb, st) {\n      // round to start\n      if (st < threshold) return 0;\n      return st;\n    };\n    var roundToEnd = function roundToEnd(sb, st, sh) {\n      // round to end\n      if (sh - (st + sb.height) < threshold) return sh - sb.height;\n      return st + _resolution[\"default\"].scale(_useScroll.affordanceSize);\n    };\n    // adding threshold into these determinations ensures that items that are within that are\n    // near the bounds of the scroller cause the edge to be scrolled into view even when the\n    // item itself is in view (e.g. due to margins)\n    var isItemBeforeView = function isItemBeforeView(ib, sb, d) {\n      return ib.top + d - threshold < sb.top;\n    };\n    var isItemAfterView = function isItemAfterView(ib, sb, d) {\n      return ib.top + d + ib.height + threshold > sb.top + sb.height;\n    };\n    var canItemFit = function canItemFit(ib, sb) {\n      return ib.height <= sb.height;\n    };\n    var calcItemAtStart = function calcItemAtStart(ib, sb, st, d) {\n      return ib.top + st + d - sb.top;\n    };\n    var calcItemAtEnd = function calcItemAtEnd(ib, sb, st, d) {\n      return ib.top + ib.height + st + d - (sb.top + sb.height);\n    };\n    var calcItemInView = function calcItemInView(ib, sb, st, sh, d) {\n      if (isItemBeforeView(ib, sb, d)) {\n        return roundToStart(sb, calcItemAtStart(ib, sb, st, d));\n      } else if (isItemAfterView(ib, sb, d)) {\n        return roundToEnd(sb, calcItemAtEnd(ib, sb, st, d), sh);\n      }\n      return st;\n    };\n    var container = getSpotlightContainerForNode(item);\n    var scrollerBounds = scrollContentRef.current.getBoundingClientRect();\n    var _scrollContentRef$cur = scrollContentRef.current,\n      scrollHeight = _scrollContentRef$cur.scrollHeight,\n      scrollTop = _scrollContentRef$cur.scrollTop;\n    var scrollTopDelta = 0;\n    var adjustScrollTop = function adjustScrollTop(v) {\n      scrollTopDelta = scrollTop - v;\n      scrollTop = v;\n    };\n    if (container) {\n      var containerBounds = container.getBoundingClientRect();\n\n      // if the entire container fits in the scroller, scroll it into view\n      if (canItemFit(containerBounds, scrollerBounds)) {\n        return calcItemInView(containerBounds, scrollerBounds, scrollTop, scrollHeight, scrollTopDelta);\n      }\n\n      // if the container doesn't fit, adjust the scroll top ...\n      if (containerBounds.top > scrollerBounds.top) {\n        // ... to the top of the container if the top is below the top of the scroller\n        adjustScrollTop(calcItemAtStart(containerBounds, scrollerBounds, scrollTop, scrollTopDelta));\n      }\n      // removing support for \"snap to bottom\" for 2.2.8\n      // } else if (containerBounds.top + containerBounds.height < scrollerBounds.top + scrollerBounds.height) {\n      // \t// ... to the bottom of the container if the bottom is above the bottom of the\n      // \t// scroller\n      // \tadjustScrollTop(calcItemAtEnd(containerBounds, scrollerBounds, scrollTop, scrollTopDelta));\n      // }\n\n      // N.B. if the container covers the scrollable area (its top is above the top of the\n      // scroller and its bottom is below the bottom of the scroller), we need not adjust the\n      // scroller to ensure the container is wholly in view.\n    }\n    var itemBounds = item.getBoundingClientRect();\n    return calcItemInView(itemBounds, scrollerBounds, scrollTop, scrollHeight, scrollTopDelta);\n  }\n\n  /**\n   * Calculates the new `scrollLeft`.\n   *\n   * @param {Node} item node\n   * @param {Number} scrollPosition last target position, passed when scroll animation is ongoing\n   *\n   * @returns {Number} Calculated `scrollLeft`\n   * @private\n   */\n  function calculateScrollLeft(item, scrollPosition) {\n    var scrollContentNode = scrollContentRef.current;\n    var _getFocusedItemBounds = getFocusedItemBounds(item),\n      itemLeft = _getFocusedItemBounds.left,\n      itemWidth = _getFocusedItemBounds.width;\n    var rtl = props.rtl,\n      coordinateCoefficient = rtl && !(_platform[\"default\"].chrome < 85) ? -1 : 1,\n      clientWidth = scrollContentHandle.current.scrollBounds.clientWidth,\n      rtlDirection = rtl ? -1 : 1,\n      _scrollContentNode$ge = scrollContentNode.getBoundingClientRect(),\n      containerLeft = _scrollContentNode$ge.left,\n      scrollLastPosition = scrollPosition ? scrollPosition : scrollContentHandle.current.scrollPos.left,\n      currentScrollLeft = rtl && coordinateCoefficient === 1 ? scrollContentHandle.current.scrollBounds.maxLeft - scrollLastPosition : scrollLastPosition,\n      newItemLeft = coordinateCoefficient * scrollContentNode.scrollLeft + (itemLeft - containerLeft);\n    var nextScrollLeft = scrollContentHandle.current.scrollPos.left;\n    if (newItemLeft + itemWidth > clientWidth + currentScrollLeft && itemWidth < clientWidth) {\n      // If focus is moved to an element outside of view area (to the right), scroller will move\n      // to the right just enough to show the current `focusedItem`. This does not apply to\n      // `focusedItem` that has a width that is bigger than `scrollBounds.clientWidth`.\n      nextScrollLeft += rtlDirection * (newItemLeft + itemWidth - (clientWidth + currentScrollLeft));\n    } else if (newItemLeft < currentScrollLeft) {\n      // If focus is outside of the view area to the left, move scroller to the left accordingly.\n      nextScrollLeft += rtlDirection * (newItemLeft - currentScrollLeft);\n    }\n    return nextScrollLeft;\n  }\n\n  /**\n   * Calculates the new top and left position for scroller based on focusedItem.\n   *\n   * @param {Node} item node\n   * @param {Number} scrollPosition last target position, passed scroll animation is ongoing\n   *\n   * @returns {Object} with keys {top, left} containing calculated top and left positions for scroll.\n   * @private\n   */\n  function calculatePositionOnFocus(_ref2) {\n    var item = _ref2.item,\n      scrollPosition = _ref2.scrollPosition;\n    var containerNode = scrollContentRef.current;\n    var horizontal = scrollContentHandle.current.isHorizontal();\n    var vertical = scrollContentHandle.current.isVertical();\n    if (!vertical && !horizontal || !item || !_utilDOM[\"default\"].containsDangerously(containerNode, item)) {\n      return;\n    }\n    var containerRect = (0, _utils.getRect)(containerNode);\n    var itemRect = (0, _utils.getRect)(item);\n    if (horizontal && !(itemRect.left >= containerRect.left + _resolution[\"default\"].scale(_useScroll.affordanceSize) && itemRect.right <= containerRect.right - _resolution[\"default\"].scale(_useScroll.affordanceSize))) {\n      scrollContentHandle.current.scrollPos.left = calculateScrollLeft(item, scrollPosition);\n    }\n    if (vertical && !(itemRect.top >= containerRect.top && itemRect.bottom <= containerRect.bottom - _resolution[\"default\"].scale(_useScroll.affordanceSize))) {\n      scrollContentHandle.current.scrollPos.top = calculateScrollTop(item);\n    }\n    return scrollContentHandle.current.scrollPos;\n  }\n  function focusOnNode(node) {\n    if (node) {\n      _spotlight[\"default\"].focus(node);\n    }\n  }\n\n  // Return\n\n  return {\n    calculatePositionOnFocus: calculatePositionOnFocus,\n    focusOnNode: focusOnNode,\n    setContainerDisabled: setContainerDisabled\n  };\n};\nvar useThemeScroller = exports.useThemeScroller = function useThemeScroller(props, scrollContentProps, contentId, isHorizontalScrollbarVisible, isVerticalScrollbarVisible) {\n  var className = scrollContentProps.className,\n    children = scrollContentProps.children,\n    editable = scrollContentProps.editable,\n    fadeOut = scrollContentProps.fadeOut,\n    scrollContainerRef = scrollContentProps.scrollContainerRef,\n    rest = _objectWithoutProperties(scrollContentProps, _excluded);\n  var scrollContainerHandle = rest.scrollContainerHandle,\n    scrollContentHandle = rest.scrollContentHandle,\n    scrollContentRef = rest.scrollContentRef;\n  delete rest.onUpdate;\n  delete rest.scrollContainerContainsDangerously;\n  delete rest.scrollContainerHandle;\n  delete rest.scrollContentHandle;\n  delete rest.setThemeScrollContentHandle;\n  delete rest.spotlightId;\n\n  // Hooks\n  var isScrollbarVisible = isHorizontalScrollbarVisible || isVerticalScrollbarVisible;\n  var _useSpottable = useSpottable(scrollContentProps, {\n      scrollContainerRef: scrollContainerRef,\n      scrollContentHandle: scrollContentHandle,\n      scrollContentRef: scrollContentRef\n    }),\n    calculatePositionOnFocus = _useSpottable.calculatePositionOnFocus,\n    focusOnNode = _useSpottable.focusOnNode,\n    setContainerDisabled = _useSpottable.setContainerDisabled;\n  var _ref3 = props.focusableScrollbar === 'byEnter' ? getFocusableBodyProps(scrollContainerRef, contentId, isScrollbarVisible) : {},\n    setNavigableFilter = _ref3.setNavigableFilter,\n    focusableBodyProps = _objectWithoutProperties(_ref3, _excluded2);\n  (0, _react.useLayoutEffect)(function () {\n    // Initial filter setting\n    if (setNavigableFilter) {\n      setNavigableFilter({\n        filterTarget: 'body'\n      });\n    }\n  }, [props.focusableScrollbar, scrollContainerRef.current]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  scrollContentProps.setThemeScrollContentHandle({\n    calculatePositionOnFocus: calculatePositionOnFocus,\n    focusOnNode: focusOnNode,\n    setContainerDisabled: setContainerDisabled\n  });\n\n  // Render\n\n  rest.className = (0, _classnames[\"default\"])(className, !isHorizontalScrollbarVisible && isVerticalScrollbarVisible && fadeOut ? _ScrollerModule[\"default\"].verticalFadeout : null, isHorizontalScrollbarVisible && !isVerticalScrollbarVisible && fadeOut ? _ScrollerModule[\"default\"].horizontalFadeout : null);\n  return {\n    editableWrapperProps: {\n      children: children,\n      editable: editable,\n      scrollContainerHandle: scrollContainerHandle,\n      scrollContainerRef: scrollContainerRef,\n      scrollContentRef: scrollContentRef\n    },\n    focusableBodyProps: focusableBodyProps,\n    themeScrollContentProps: _objectSpread({}, rest)\n  };\n};\nvar _default = exports[\"default\"] = useThemeScroller;"],"mappings":"AAAA,YAAY;;AAEZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAC3CC,KAAK,EAAE;AACT,CAAC,CAAC;AACFD,OAAO,CAACE,gBAAgB,GAAGF,OAAO,CAAC,SAAS,CAAC,GAAG,KAAK,CAAC;AACtD,IAAIG,OAAO,GAAGC,OAAO,CAAC,oBAAoB,CAAC;AAC3C,IAAIC,OAAO,GAAGD,OAAO,CAAC,oBAAoB,CAAC;AAC3C,IAAIE,SAAS,GAAGC,sBAAsB,CAACH,OAAO,CAAC,sBAAsB,CAAC,CAAC;AACvE,IAAII,UAAU,GAAGD,sBAAsB,CAACH,OAAO,CAAC,kBAAkB,CAAC,CAAC;AACpE,IAAIK,MAAM,GAAGL,OAAO,CAAC,4BAA4B,CAAC;AAClD,IAAIM,WAAW,GAAGH,sBAAsB,CAACH,OAAO,CAAC,sBAAsB,CAAC,CAAC;AACzE,IAAIO,QAAQ,GAAGJ,sBAAsB,CAACH,OAAO,CAAC,6BAA6B,CAAC,CAAC;AAC7E,IAAIQ,WAAW,GAAGL,sBAAsB,CAACH,OAAO,CAAC,YAAY,CAAC,CAAC;AAC/D,IAAIS,MAAM,GAAGT,OAAO,CAAC,OAAO,CAAC;AAC7B,IAAIU,UAAU,GAAGV,OAAO,CAAC,cAAc,CAAC;AACxC,IAAIW,SAAS,GAAGX,OAAO,CAAC,YAAY,CAAC;AACrC,IAAIY,eAAe,GAAGT,sBAAsB,CAACH,OAAO,CAAC,uBAAuB,CAAC,CAAC;AAC9E,IAAIa,qBAAqB,GAAGV,sBAAsB,CAACH,OAAO,CAAC,wCAAwC,CAAC,CAAC;AACrG,IAAIc,SAAS,GAAG,CAAC,WAAW,EAAE,UAAU,EAAE,UAAU,EAAE,SAAS,EAAE,oBAAoB,CAAC;EACpFC,UAAU,GAAG,CAAC,oBAAoB,CAAC;AACrC,SAASZ,sBAAsBA,CAACa,GAAG,EAAE;EAAE,OAAOA,GAAG,IAAIA,GAAG,CAACC,UAAU,GAAGD,GAAG,GAAG;IAAE,SAAS,EAAEA;EAAI,CAAC;AAAE;AAChG,SAASE,OAAOA,CAACC,CAAC,EAAEC,CAAC,EAAE;EAAE,IAAIC,CAAC,GAAG3B,MAAM,CAAC4B,IAAI,CAACH,CAAC,CAAC;EAAE,IAAIzB,MAAM,CAAC6B,qBAAqB,EAAE;IAAE,IAAIC,CAAC,GAAG9B,MAAM,CAAC6B,qBAAqB,CAACJ,CAAC,CAAC;IAAEC,CAAC,KAAKI,CAAC,GAAGA,CAAC,CAACC,MAAM,CAAC,UAAUL,CAAC,EAAE;MAAE,OAAO1B,MAAM,CAACgC,wBAAwB,CAACP,CAAC,EAAEC,CAAC,CAAC,CAACO,UAAU;IAAE,CAAC,CAAC,CAAC,EAAEN,CAAC,CAACO,IAAI,CAACC,KAAK,CAACR,CAAC,EAAEG,CAAC,CAAC;EAAE;EAAE,OAAOH,CAAC;AAAE;AAC9P,SAASS,aAAaA,CAACX,CAAC,EAAE;EAAE,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGW,SAAS,CAACC,MAAM,EAAEZ,CAAC,EAAE,EAAE;IAAE,IAAIC,CAAC,GAAG,IAAI,IAAIU,SAAS,CAACX,CAAC,CAAC,GAAGW,SAAS,CAACX,CAAC,CAAC,GAAG,CAAC,CAAC;IAAEA,CAAC,GAAG,CAAC,GAAGF,OAAO,CAACxB,MAAM,CAAC2B,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACY,OAAO,CAAC,UAAUb,CAAC,EAAE;MAAEc,eAAe,CAACf,CAAC,EAAEC,CAAC,EAAEC,CAAC,CAACD,CAAC,CAAC,CAAC;IAAE,CAAC,CAAC,GAAG1B,MAAM,CAACyC,yBAAyB,GAAGzC,MAAM,CAAC0C,gBAAgB,CAACjB,CAAC,EAAEzB,MAAM,CAACyC,yBAAyB,CAACd,CAAC,CAAC,CAAC,GAAGH,OAAO,CAACxB,MAAM,CAAC2B,CAAC,CAAC,CAAC,CAACY,OAAO,CAAC,UAAUb,CAAC,EAAE;MAAE1B,MAAM,CAACC,cAAc,CAACwB,CAAC,EAAEC,CAAC,EAAE1B,MAAM,CAACgC,wBAAwB,CAACL,CAAC,EAAED,CAAC,CAAC,CAAC;IAAE,CAAC,CAAC;EAAE;EAAE,OAAOD,CAAC;AAAE;AACtb,SAASe,eAAeA,CAAClB,GAAG,EAAEqB,GAAG,EAAExC,KAAK,EAAE;EAAEwC,GAAG,GAAGC,cAAc,CAACD,GAAG,CAAC;EAAE,IAAIA,GAAG,IAAIrB,GAAG,EAAE;IAAEtB,MAAM,CAACC,cAAc,CAACqB,GAAG,EAAEqB,GAAG,EAAE;MAAExC,KAAK,EAAEA,KAAK;MAAE8B,UAAU,EAAE,IAAI;MAAEY,YAAY,EAAE,IAAI;MAAEC,QAAQ,EAAE;IAAK,CAAC,CAAC;EAAE,CAAC,MAAM;IAAExB,GAAG,CAACqB,GAAG,CAAC,GAAGxC,KAAK;EAAE;EAAE,OAAOmB,GAAG;AAAE;AAC3O,SAASsB,cAAcA,CAACjB,CAAC,EAAE;EAAE,IAAIoB,CAAC,GAAGC,YAAY,CAACrB,CAAC,EAAE,QAAQ,CAAC;EAAE,OAAO,QAAQ,IAAI,OAAOoB,CAAC,GAAGA,CAAC,GAAGE,MAAM,CAACF,CAAC,CAAC;AAAE;AAC7G,SAASC,YAAYA,CAACrB,CAAC,EAAED,CAAC,EAAE;EAAE,IAAI,QAAQ,IAAI,OAAOC,CAAC,IAAI,CAACA,CAAC,EAAE,OAAOA,CAAC;EAAE,IAAIF,CAAC,GAAGE,CAAC,CAACuB,MAAM,CAACC,WAAW,CAAC;EAAE,IAAI,KAAK,CAAC,KAAK1B,CAAC,EAAE;IAAE,IAAIsB,CAAC,GAAGtB,CAAC,CAAC2B,IAAI,CAACzB,CAAC,EAAED,CAAC,IAAI,SAAS,CAAC;IAAE,IAAI,QAAQ,IAAI,OAAOqB,CAAC,EAAE,OAAOA,CAAC;IAAE,MAAM,IAAIM,SAAS,CAAC,8CAA8C,CAAC;EAAE;EAAE,OAAO,CAAC,QAAQ,KAAK3B,CAAC,GAAGuB,MAAM,GAAGK,MAAM,EAAE3B,CAAC,CAAC;AAAE;AACvT,SAAS4B,wBAAwBA,CAACC,MAAM,EAAEC,QAAQ,EAAE;EAAE,IAAID,MAAM,IAAI,IAAI,EAAE,OAAO,CAAC,CAAC;EAAE,IAAIE,MAAM,GAAGC,6BAA6B,CAACH,MAAM,EAAEC,QAAQ,CAAC;EAAE,IAAId,GAAG,EAAEI,CAAC;EAAE,IAAI/C,MAAM,CAAC6B,qBAAqB,EAAE;IAAE,IAAI+B,gBAAgB,GAAG5D,MAAM,CAAC6B,qBAAqB,CAAC2B,MAAM,CAAC;IAAE,KAAKT,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGa,gBAAgB,CAACtB,MAAM,EAAES,CAAC,EAAE,EAAE;MAAEJ,GAAG,GAAGiB,gBAAgB,CAACb,CAAC,CAAC;MAAE,IAAIU,QAAQ,CAACI,OAAO,CAAClB,GAAG,CAAC,IAAI,CAAC,EAAE;MAAU,IAAI,CAAC3C,MAAM,CAAC8D,SAAS,CAACC,oBAAoB,CAACX,IAAI,CAACI,MAAM,EAAEb,GAAG,CAAC,EAAE;MAAUe,MAAM,CAACf,GAAG,CAAC,GAAGa,MAAM,CAACb,GAAG,CAAC;IAAE;EAAE;EAAE,OAAOe,MAAM;AAAE;AAC3e,SAASC,6BAA6BA,CAACH,MAAM,EAAEC,QAAQ,EAAE;EAAE,IAAID,MAAM,IAAI,IAAI,EAAE,OAAO,CAAC,CAAC;EAAE,IAAIE,MAAM,GAAG,CAAC,CAAC;EAAE,IAAIM,UAAU,GAAGhE,MAAM,CAAC4B,IAAI,CAAC4B,MAAM,CAAC;EAAE,IAAIb,GAAG,EAAEI,CAAC;EAAE,KAAKA,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiB,UAAU,CAAC1B,MAAM,EAAES,CAAC,EAAE,EAAE;IAAEJ,GAAG,GAAGqB,UAAU,CAACjB,CAAC,CAAC;IAAE,IAAIU,QAAQ,CAACI,OAAO,CAAClB,GAAG,CAAC,IAAI,CAAC,EAAE;IAAUe,MAAM,CAACf,GAAG,CAAC,GAAGa,MAAM,CAACb,GAAG,CAAC;EAAE;EAAE,OAAOe,MAAM;AAAE;AAClT,IAAIO,QAAQ,GAAG,CAAC,CAAC,EAAE1D,OAAO,CAAC2D,EAAE,EAAE,QAAQ,CAAC;EACtCC,OAAO,GAAG,CAAC,CAAC,EAAE5D,OAAO,CAAC2D,EAAE,EAAE,OAAO,CAAC;EAClCE,MAAM,GAAG,SAASA,MAAMA,CAACC,IAAI,EAAE;IAC7B,OAAOA,IAAI,CAACC,SAAS,CAACC,QAAQ,CAACrD,eAAe,CAAC,SAAS,CAAC,CAACsD,aAAa,CAAC;EAC1E,CAAC;AACH,IAAIC,qBAAqB,GAAG,SAASA,qBAAqBA,CAACC,kBAAkB,EAAEC,SAAS,EAAEC,kBAAkB,EAAE;EAC5G,IAAIC,WAAW,GAAGH,kBAAkB,CAACI,OAAO,IAAIJ,kBAAkB,CAACI,OAAO,CAACC,OAAO,CAACF,WAAW;EAC9F,IAAIG,kBAAkB,GAAG,IAAI;EAC7B,IAAIC,kBAAkB,GAAG,SAASA,kBAAkBA,CAACC,IAAI,EAAE;IACzD,IAAIC,YAAY,GAAGD,IAAI,CAACC,YAAY;IACpCN,WAAW,GAAGH,kBAAkB,CAACI,OAAO,IAAIJ,kBAAkB,CAACI,OAAO,CAACC,OAAO,CAACF,WAAW;IAC1F,IAAIA,WAAW,IAAIM,YAAY,EAAE;MAC/B,IAAIC,eAAe,GAAGD,YAAY,KAAK,MAAM,GAAGjE,eAAe,CAAC,SAAS,CAAC,CAACsD,aAAa,GAAGrD,qBAAqB,CAAC,SAAS,CAAC,CAACkE,KAAK;MACjI3E,UAAU,CAAC,SAAS,CAAC,CAAC4E,GAAG,CAACT,WAAW,EAAE;QACrCU,eAAe,EAAE,SAASA,eAAeA,CAAClB,IAAI,EAAE;UAC9C,OAAO,OAAOA,IAAI,KAAK,QAAQ,IAAI,CAACA,IAAI,CAACC,SAAS,CAACC,QAAQ,CAACa,eAAe,CAAC;QAC9E;MACF,CAAC,CAAC;MACF,OAAO,IAAI;IACb;IACA,OAAO,KAAK;EACd,CAAC;EACD,IAAII,wBAAwB,GAAG,SAASA,wBAAwBA,CAACC,EAAE,EAAE;IACnE,IAAIC,OAAO,GAAGD,EAAE,CAACC,OAAO;MACtBhC,MAAM,GAAG+B,EAAE,CAAC/B,MAAM;MAClBiC,IAAI,GAAGF,EAAE,CAACE,IAAI;IAChB,IAAIR,YAAY,GAAG,IAAI;IACvB,IAAI,CAACP,kBAAkB,EAAE;MACvB,OAAO;QACLO,YAAY,EAAEA;MAChB,CAAC;IACH;IACA,IAAIQ,IAAI,KAAK,OAAO,EAAE;MACpBR,YAAY,GAAGf,MAAM,CAACV,MAAM,CAAC,GAAG,OAAO,GAAG,MAAM;IAClD,CAAC,MAAM,IAAIiC,IAAI,KAAK,MAAM,EAAE;MAC1BR,YAAY,GAAG,MAAM;IACvB,CAAC,MAAM,IAAIQ,IAAI,KAAK,SAAS,EAAE;MAC7BR,YAAY,GAAG,CAACzE,UAAU,CAAC,SAAS,CAAC,CAACkF,cAAc,CAAC,CAAC,IAAIzB,OAAO,CAACuB,OAAO,CAAC,IAAItB,MAAM,CAACV,MAAM,CAAC,IAAI,MAAM,IAAIS,OAAO,CAACuB,OAAO,CAAC,IAAI,CAACtB,MAAM,CAACV,MAAM,CAAC,IAAI,OAAO,IAAIO,QAAQ,CAACyB,OAAO,CAAC,IAAI,CAACtB,MAAM,CAACV,MAAM,CAAC,IAAI,OAAO,IAAI,IAAI;IACrN;IACA,OAAO;MACLyB,YAAY,EAAEA;IAChB,CAAC;EACH,CAAC;EACD,IAAIU,4BAA4B,GAAG,SAASA,4BAA4BA,CAACJ,EAAE,EAAE;IAC3E,IAAIC,OAAO,GAAGD,EAAE,CAACC,OAAO;MACtBhC,MAAM,GAAG+B,EAAE,CAAC/B,MAAM;IACpB,IAAIoC,UAAU;IACd,IAAI1B,MAAM,CAACV,MAAM,CAAC,EAAE;MAClB;MACA;MACA,IAAIqC,oBAAoB,GAAGrF,UAAU,CAAC,SAAS,CAAC,CAACsF,uBAAuB,CAACnB,WAAW,CAAC;MACrF,IAAIkB,oBAAoB,CAACzD,MAAM,GAAG,CAAC,EAAE;QACnC;QACAwD,UAAU,GAAGC,oBAAoB,CAACE,GAAG,CAAC,CAAC;;QAEvC;QACA,IAAIC,aAAa,GAAGH,oBAAoB,CAACE,GAAG,CAAC,CAAC;QAC9CH,UAAU,GAAGI,aAAa,IAAIA,aAAa,CAAC5B,SAAS,CAACC,QAAQ,CAACpD,qBAAqB,CAAC,SAAS,CAAC,CAACkE,KAAK,CAAC,GAAGa,aAAa,GAAGJ,UAAU;MACrI;IACF,CAAC,MAAM;MACL;MACA;MACAA,UAAU,GAAGpC,MAAM,CAACyC,OAAO,CAAC,GAAG,CAACC,MAAM,CAAClF,eAAe,CAAC,SAAS,CAAC,CAACsD,aAAa,CAAC,CAAC;MACjFQ,kBAAkB,GAAGf,QAAQ,CAACyB,OAAO,CAAC,IAAII,UAAU,IAAI,IAAI;IAC9D;IACA,IAAIA,UAAU,EAAE;MACdpF,UAAU,CAAC,SAAS,CAAC,CAAC2F,KAAK,CAACP,UAAU,CAAC;MACvCL,EAAE,CAACa,cAAc,CAAC,CAAC;MACnBb,EAAE,CAACc,WAAW,CAACC,wBAAwB,CAAC,CAAC;IAC3C;EACF,CAAC;EACD,IAAIC,iBAAiB,GAAG,SAASA,iBAAiBA,CAAChB,EAAE,EAAE;IACrD,IAAIC,OAAO,GAAGD,EAAE,CAACC,OAAO;MACtBhC,MAAM,GAAG+B,EAAE,CAAC/B,MAAM;IACpB,IAAIO,QAAQ,CAACyB,OAAO,CAAC,IAAIhC,MAAM,KAAKsB,kBAAkB,EAAE;MACtDS,EAAE,CAACc,WAAW,CAACC,wBAAwB,CAAC,CAAC;IAC3C;IACAxB,kBAAkB,GAAG,IAAI;EAC3B,CAAC;EACD,OAAO;IACL,iBAAiB,EAAEL,SAAS;IAC5B+B,SAAS,EAAExF,eAAe,CAAC,SAAS,CAAC,CAACsD,aAAa;IACnDmC,OAAO,EAAE,CAAC,CAAC,EAAEtG,OAAO,CAACuG,MAAM,EAAE,CAAC,CAAC,EAAEvG,OAAO,CAACwG,OAAO,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC,EAAExG,OAAO,CAACyG,UAAU,EAAEtB,wBAAwB,EAAEP,kBAAkB,CAAC,CAAC;IACpI8B,MAAM,EAAE,CAAC,CAAC,EAAE1G,OAAO,CAACuG,MAAM;IAC1B;IACA,CAAC,CAAC,EAAEvG,OAAO,CAACwG,OAAO,EAAE,QAAQ,CAAC,EAAE,CAAC,CAAC,EAAExG,OAAO,CAACyG,UAAU,EAAEtB,wBAAwB,EAAEP,kBAAkB,CAAC,CAAC;IACtG+B,SAAS,EAAE,CAAC,CAAC,EAAE3G,OAAO,CAACuG,MAAM,EAAE,CAAC,CAAC,EAAEvG,OAAO,CAACwG,OAAO,EAAE,WAAW,CAAC,EAAE,CAAC,CAAC,EAAExG,OAAO,CAACyG,UAAU,EAAEtB,wBAAwB,EAAEP,kBAAkB,CAAC,EAAEY,4BAA4B,CAAC;IACtKoB,OAAO,EAAE,CAAC,CAAC,EAAE5G,OAAO,CAACuG,MAAM,EAAEH,iBAAiB,CAAC;IAC/CxB,kBAAkB,EAAEA;EACtB,CAAC;AACH,CAAC;AACD,IAAIiC,YAAY,GAAG,SAASA,YAAYA,CAACC,KAAK,EAAEC,SAAS,EAAE;EACzD,IAAI1C,kBAAkB,GAAG0C,SAAS,CAAC1C,kBAAkB;IACnD2C,mBAAmB,GAAGD,SAAS,CAACC,mBAAmB;IACnDC,gBAAgB,GAAGF,SAAS,CAACE,gBAAgB;;EAE/C;;EAEA,IAAIC,YAAY,GAAG,CAAC,CAAC,EAAEtG,SAAS,CAACuG,WAAW,EAAE,CAAC;IAC7CC,6BAA6B,GAAGF,YAAY,CAACE,6BAA6B;IAC1EC,gCAAgC,GAAGH,YAAY,CAACG,gCAAgC;EAClF,IAAIC,oBAAoB,GAAG,CAAC,CAAC,EAAE5G,MAAM,CAAC6G,WAAW,EAAE,UAAUC,IAAI,EAAE;IACjE,IAAInD,kBAAkB,CAACI,OAAO,EAAE;MAC9BJ,kBAAkB,CAACI,OAAO,CAACC,OAAO,CAAC+C,0BAA0B,GAAGD,IAAI;MACpE,IAAIA,IAAI,EAAE;QACRJ,6BAA6B,CAAC,YAAY;UACxCE,oBAAoB,CAAC,KAAK,CAAC;QAC7B,CAAC,CAAC;MACJ,CAAC,MAAM;QACLD,gCAAgC,CAAC,CAAC;MACpC;IACF;EACF,CAAC,EAAE,CAACD,6BAA6B,EAAEC,gCAAgC,EAAEhD,kBAAkB,CAAC,CAAC;EACzF,CAAC,CAAC,EAAE3D,MAAM,CAACgH,SAAS,EAAE,YAAY;IAChC,OAAO,YAAY;MACjB,OAAOJ,oBAAoB,CAAC,KAAK,CAAC;IACpC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;;EAER,CAAC,CAAC,EAAE5G,MAAM,CAACgH,SAAS,EAAE,YAAY;IAChC,IAAIC,QAAQ,GAAGb,KAAK,CAACa,QAAQ;IAC7B,IAAIA,QAAQ,EAAE;MACZA,QAAQ,CAAC,CAAC;IACZ;EACF,CAAC,CAAC;;EAEF;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACE,SAASC,4BAA4BA,CAACC,IAAI,EAAE;IAC1C,GAAG;MACD,IAAIA,IAAI,CAACnD,OAAO,CAACF,WAAW,IAAIqD,IAAI,CAACnD,OAAO,CAACoD,kBAAkB,IAAI,CAACD,IAAI,CAACnD,OAAO,CAACqD,mBAAmB,EAAE;QACpG,OAAOF,IAAI;MACb;IACF,CAAC,QAAQ,CAACA,IAAI,GAAGA,IAAI,CAACG,UAAU,KAAKH,IAAI,KAAKZ,gBAAgB,CAACxC,OAAO;EACxE;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE,SAASwD,oBAAoBA,CAACJ,IAAI,EAAE;IAClCA,IAAI,GAAGD,4BAA4B,CAACC,IAAI,CAAC,IAAIA,IAAI;IACjD,OAAOA,IAAI,CAACK,qBAAqB,CAAC,CAAC;EACrC;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACE,SAASC,kBAAkBA,CAACC,IAAI,EAAE;IAChC,IAAIC,SAAS,GAAG9H,WAAW,CAAC,SAAS,CAAC,CAAC+H,KAAK,CAAC,EAAE,CAAC;IAChD,IAAIC,YAAY,GAAG,SAASA,YAAYA,CAACC,EAAE,EAAEC,EAAE,EAAE;MAC/C;MACA,IAAIA,EAAE,GAAGJ,SAAS,EAAE,OAAO,CAAC;MAC5B,OAAOI,EAAE;IACX,CAAC;IACD,IAAIC,UAAU,GAAG,SAASA,UAAUA,CAACF,EAAE,EAAEC,EAAE,EAAEE,EAAE,EAAE;MAC/C;MACA,IAAIA,EAAE,IAAIF,EAAE,GAAGD,EAAE,CAACI,MAAM,CAAC,GAAGP,SAAS,EAAE,OAAOM,EAAE,GAAGH,EAAE,CAACI,MAAM;MAC5D,OAAOH,EAAE,GAAGlI,WAAW,CAAC,SAAS,CAAC,CAAC+H,KAAK,CAAC3H,UAAU,CAACkI,cAAc,CAAC;IACrE,CAAC;IACD;IACA;IACA;IACA,IAAIC,gBAAgB,GAAG,SAASA,gBAAgBA,CAACC,EAAE,EAAEP,EAAE,EAAEQ,CAAC,EAAE;MAC1D,OAAOD,EAAE,CAACE,GAAG,GAAGD,CAAC,GAAGX,SAAS,GAAGG,EAAE,CAACS,GAAG;IACxC,CAAC;IACD,IAAIC,eAAe,GAAG,SAASA,eAAeA,CAACH,EAAE,EAAEP,EAAE,EAAEQ,CAAC,EAAE;MACxD,OAAOD,EAAE,CAACE,GAAG,GAAGD,CAAC,GAAGD,EAAE,CAACH,MAAM,GAAGP,SAAS,GAAGG,EAAE,CAACS,GAAG,GAAGT,EAAE,CAACI,MAAM;IAChE,CAAC;IACD,IAAIO,UAAU,GAAG,SAASA,UAAUA,CAACJ,EAAE,EAAEP,EAAE,EAAE;MAC3C,OAAOO,EAAE,CAACH,MAAM,IAAIJ,EAAE,CAACI,MAAM;IAC/B,CAAC;IACD,IAAIQ,eAAe,GAAG,SAASA,eAAeA,CAACL,EAAE,EAAEP,EAAE,EAAEC,EAAE,EAAEO,CAAC,EAAE;MAC5D,OAAOD,EAAE,CAACE,GAAG,GAAGR,EAAE,GAAGO,CAAC,GAAGR,EAAE,CAACS,GAAG;IACjC,CAAC;IACD,IAAII,aAAa,GAAG,SAASA,aAAaA,CAACN,EAAE,EAAEP,EAAE,EAAEC,EAAE,EAAEO,CAAC,EAAE;MACxD,OAAOD,EAAE,CAACE,GAAG,GAAGF,EAAE,CAACH,MAAM,GAAGH,EAAE,GAAGO,CAAC,IAAIR,EAAE,CAACS,GAAG,GAAGT,EAAE,CAACI,MAAM,CAAC;IAC3D,CAAC;IACD,IAAIU,cAAc,GAAG,SAASA,cAAcA,CAACP,EAAE,EAAEP,EAAE,EAAEC,EAAE,EAAEE,EAAE,EAAEK,CAAC,EAAE;MAC9D,IAAIF,gBAAgB,CAACC,EAAE,EAAEP,EAAE,EAAEQ,CAAC,CAAC,EAAE;QAC/B,OAAOT,YAAY,CAACC,EAAE,EAAEY,eAAe,CAACL,EAAE,EAAEP,EAAE,EAAEC,EAAE,EAAEO,CAAC,CAAC,CAAC;MACzD,CAAC,MAAM,IAAIE,eAAe,CAACH,EAAE,EAAEP,EAAE,EAAEQ,CAAC,CAAC,EAAE;QACrC,OAAON,UAAU,CAACF,EAAE,EAAEa,aAAa,CAACN,EAAE,EAAEP,EAAE,EAAEC,EAAE,EAAEO,CAAC,CAAC,EAAEL,EAAE,CAAC;MACzD;MACA,OAAOF,EAAE;IACX,CAAC;IACD,IAAIc,SAAS,GAAG3B,4BAA4B,CAACQ,IAAI,CAAC;IAClD,IAAIoB,cAAc,GAAGvC,gBAAgB,CAACxC,OAAO,CAACyD,qBAAqB,CAAC,CAAC;IACrE,IAAIuB,qBAAqB,GAAGxC,gBAAgB,CAACxC,OAAO;MAClDiF,YAAY,GAAGD,qBAAqB,CAACC,YAAY;MACjDC,SAAS,GAAGF,qBAAqB,CAACE,SAAS;IAC7C,IAAIC,cAAc,GAAG,CAAC;IACtB,IAAIC,eAAe,GAAG,SAASA,eAAeA,CAACC,CAAC,EAAE;MAChDF,cAAc,GAAGD,SAAS,GAAGG,CAAC;MAC9BH,SAAS,GAAGG,CAAC;IACf,CAAC;IACD,IAAIP,SAAS,EAAE;MACb,IAAIQ,eAAe,GAAGR,SAAS,CAACrB,qBAAqB,CAAC,CAAC;;MAEvD;MACA,IAAIiB,UAAU,CAACY,eAAe,EAAEP,cAAc,CAAC,EAAE;QAC/C,OAAOF,cAAc,CAACS,eAAe,EAAEP,cAAc,EAAEG,SAAS,EAAED,YAAY,EAAEE,cAAc,CAAC;MACjG;;MAEA;MACA,IAAIG,eAAe,CAACd,GAAG,GAAGO,cAAc,CAACP,GAAG,EAAE;QAC5C;QACAY,eAAe,CAACT,eAAe,CAACW,eAAe,EAAEP,cAAc,EAAEG,SAAS,EAAEC,cAAc,CAAC,CAAC;MAC9F;MACA;MACA;MACA;MACA;MACA;MACA;;MAEA;MACA;MACA;IACF;;IACA,IAAII,UAAU,GAAG5B,IAAI,CAACF,qBAAqB,CAAC,CAAC;IAC7C,OAAOoB,cAAc,CAACU,UAAU,EAAER,cAAc,EAAEG,SAAS,EAAED,YAAY,EAAEE,cAAc,CAAC;EAC5F;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE,SAASK,mBAAmBA,CAAC7B,IAAI,EAAE8B,cAAc,EAAE;IACjD,IAAIC,iBAAiB,GAAGlD,gBAAgB,CAACxC,OAAO;IAChD,IAAI2F,qBAAqB,GAAGnC,oBAAoB,CAACG,IAAI,CAAC;MACpDiC,QAAQ,GAAGD,qBAAqB,CAACE,IAAI;MACrCC,SAAS,GAAGH,qBAAqB,CAACI,KAAK;IACzC,IAAIC,GAAG,GAAG3D,KAAK,CAAC2D,GAAG;MACjBC,qBAAqB,GAAGD,GAAG,IAAI,EAAEtK,SAAS,CAAC,SAAS,CAAC,CAACwK,MAAM,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;MAC3EC,WAAW,GAAG5D,mBAAmB,CAACvC,OAAO,CAACoG,YAAY,CAACD,WAAW;MAClEE,YAAY,GAAGL,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC;MAC3BM,qBAAqB,GAAGZ,iBAAiB,CAACjC,qBAAqB,CAAC,CAAC;MACjE8C,aAAa,GAAGD,qBAAqB,CAACT,IAAI;MAC1CW,kBAAkB,GAAGf,cAAc,GAAGA,cAAc,GAAGlD,mBAAmB,CAACvC,OAAO,CAACyG,SAAS,CAACZ,IAAI;MACjGa,iBAAiB,GAAGV,GAAG,IAAIC,qBAAqB,KAAK,CAAC,GAAG1D,mBAAmB,CAACvC,OAAO,CAACoG,YAAY,CAACO,OAAO,GAAGH,kBAAkB,GAAGA,kBAAkB;MACnJI,WAAW,GAAGX,qBAAqB,GAAGP,iBAAiB,CAACmB,UAAU,IAAIjB,QAAQ,GAAGW,aAAa,CAAC;IACjG,IAAIO,cAAc,GAAGvE,mBAAmB,CAACvC,OAAO,CAACyG,SAAS,CAACZ,IAAI;IAC/D,IAAIe,WAAW,GAAGd,SAAS,GAAGK,WAAW,GAAGO,iBAAiB,IAAIZ,SAAS,GAAGK,WAAW,EAAE;MACxF;MACA;MACA;MACAW,cAAc,IAAIT,YAAY,IAAIO,WAAW,GAAGd,SAAS,IAAIK,WAAW,GAAGO,iBAAiB,CAAC,CAAC;IAChG,CAAC,MAAM,IAAIE,WAAW,GAAGF,iBAAiB,EAAE;MAC1C;MACAI,cAAc,IAAIT,YAAY,IAAIO,WAAW,GAAGF,iBAAiB,CAAC;IACpE;IACA,OAAOI,cAAc;EACvB;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE,SAASC,wBAAwBA,CAACC,KAAK,EAAE;IACvC,IAAIrD,IAAI,GAAGqD,KAAK,CAACrD,IAAI;MACnB8B,cAAc,GAAGuB,KAAK,CAACvB,cAAc;IACvC,IAAIwB,aAAa,GAAGzE,gBAAgB,CAACxC,OAAO;IAC5C,IAAIkH,UAAU,GAAG3E,mBAAmB,CAACvC,OAAO,CAACmH,YAAY,CAAC,CAAC;IAC3D,IAAIC,QAAQ,GAAG7E,mBAAmB,CAACvC,OAAO,CAACqH,UAAU,CAAC,CAAC;IACvD,IAAI,CAACD,QAAQ,IAAI,CAACF,UAAU,IAAI,CAACvD,IAAI,IAAI,CAAC5H,QAAQ,CAAC,SAAS,CAAC,CAACuL,mBAAmB,CAACL,aAAa,EAAEtD,IAAI,CAAC,EAAE;MACtG;IACF;IACA,IAAI4D,aAAa,GAAG,CAAC,CAAC,EAAE1L,MAAM,CAAC2L,OAAO,EAAEP,aAAa,CAAC;IACtD,IAAIQ,QAAQ,GAAG,CAAC,CAAC,EAAE5L,MAAM,CAAC2L,OAAO,EAAE7D,IAAI,CAAC;IACxC,IAAIuD,UAAU,IAAI,EAAEO,QAAQ,CAAC5B,IAAI,IAAI0B,aAAa,CAAC1B,IAAI,GAAG/J,WAAW,CAAC,SAAS,CAAC,CAAC+H,KAAK,CAAC3H,UAAU,CAACkI,cAAc,CAAC,IAAIqD,QAAQ,CAACC,KAAK,IAAIH,aAAa,CAACG,KAAK,GAAG5L,WAAW,CAAC,SAAS,CAAC,CAAC+H,KAAK,CAAC3H,UAAU,CAACkI,cAAc,CAAC,CAAC,EAAE;MACrN7B,mBAAmB,CAACvC,OAAO,CAACyG,SAAS,CAACZ,IAAI,GAAGL,mBAAmB,CAAC7B,IAAI,EAAE8B,cAAc,CAAC;IACxF;IACA,IAAI2B,QAAQ,IAAI,EAAEK,QAAQ,CAACjD,GAAG,IAAI+C,aAAa,CAAC/C,GAAG,IAAIiD,QAAQ,CAACE,MAAM,IAAIJ,aAAa,CAACI,MAAM,GAAG7L,WAAW,CAAC,SAAS,CAAC,CAAC+H,KAAK,CAAC3H,UAAU,CAACkI,cAAc,CAAC,CAAC,EAAE;MACzJ7B,mBAAmB,CAACvC,OAAO,CAACyG,SAAS,CAACjC,GAAG,GAAGd,kBAAkB,CAACC,IAAI,CAAC;IACtE;IACA,OAAOpB,mBAAmB,CAACvC,OAAO,CAACyG,SAAS;EAC9C;EACA,SAASmB,WAAWA,CAACxE,IAAI,EAAE;IACzB,IAAIA,IAAI,EAAE;MACRxH,UAAU,CAAC,SAAS,CAAC,CAAC2F,KAAK,CAAC6B,IAAI,CAAC;IACnC;EACF;;EAEA;;EAEA,OAAO;IACL2D,wBAAwB,EAAEA,wBAAwB;IAClDa,WAAW,EAAEA,WAAW;IACxB/E,oBAAoB,EAAEA;EACxB,CAAC;AACH,CAAC;AACD,IAAIvH,gBAAgB,GAAGF,OAAO,CAACE,gBAAgB,GAAG,SAASA,gBAAgBA,CAAC+G,KAAK,EAAEwF,kBAAkB,EAAEhI,SAAS,EAAEiI,4BAA4B,EAAEC,0BAA0B,EAAE;EAC1K,IAAInG,SAAS,GAAGiG,kBAAkB,CAACjG,SAAS;IAC1CoG,QAAQ,GAAGH,kBAAkB,CAACG,QAAQ;IACtCC,QAAQ,GAAGJ,kBAAkB,CAACI,QAAQ;IACtCC,OAAO,GAAGL,kBAAkB,CAACK,OAAO;IACpCtI,kBAAkB,GAAGiI,kBAAkB,CAACjI,kBAAkB;IAC1DuI,IAAI,GAAG1J,wBAAwB,CAACoJ,kBAAkB,EAAEvL,SAAS,CAAC;EAChE,IAAI8L,qBAAqB,GAAGD,IAAI,CAACC,qBAAqB;IACpD7F,mBAAmB,GAAG4F,IAAI,CAAC5F,mBAAmB;IAC9CC,gBAAgB,GAAG2F,IAAI,CAAC3F,gBAAgB;EAC1C,OAAO2F,IAAI,CAACjF,QAAQ;EACpB,OAAOiF,IAAI,CAACE,kCAAkC;EAC9C,OAAOF,IAAI,CAACC,qBAAqB;EACjC,OAAOD,IAAI,CAAC5F,mBAAmB;EAC/B,OAAO4F,IAAI,CAACG,2BAA2B;EACvC,OAAOH,IAAI,CAACpI,WAAW;;EAEvB;EACA,IAAID,kBAAkB,GAAGgI,4BAA4B,IAAIC,0BAA0B;EACnF,IAAIQ,aAAa,GAAGnG,YAAY,CAACyF,kBAAkB,EAAE;MACjDjI,kBAAkB,EAAEA,kBAAkB;MACtC2C,mBAAmB,EAAEA,mBAAmB;MACxCC,gBAAgB,EAAEA;IACpB,CAAC,CAAC;IACFuE,wBAAwB,GAAGwB,aAAa,CAACxB,wBAAwB;IACjEa,WAAW,GAAGW,aAAa,CAACX,WAAW;IACvC/E,oBAAoB,GAAG0F,aAAa,CAAC1F,oBAAoB;EAC3D,IAAI2F,KAAK,GAAGnG,KAAK,CAACoG,kBAAkB,KAAK,SAAS,GAAG9I,qBAAqB,CAACC,kBAAkB,EAAEC,SAAS,EAAEC,kBAAkB,CAAC,GAAG,CAAC,CAAC;IAChIK,kBAAkB,GAAGqI,KAAK,CAACrI,kBAAkB;IAC7CuI,kBAAkB,GAAGjK,wBAAwB,CAAC+J,KAAK,EAAEjM,UAAU,CAAC;EAClE,CAAC,CAAC,EAAEN,MAAM,CAAC0M,eAAe,EAAE,YAAY;IACtC;IACA,IAAIxI,kBAAkB,EAAE;MACtBA,kBAAkB,CAAC;QACjBE,YAAY,EAAE;MAChB,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAACgC,KAAK,CAACoG,kBAAkB,EAAE7I,kBAAkB,CAACI,OAAO,CAAC,CAAC,CAAC,CAAC;;EAE5D6H,kBAAkB,CAACS,2BAA2B,CAAC;IAC7CvB,wBAAwB,EAAEA,wBAAwB;IAClDa,WAAW,EAAEA,WAAW;IACxB/E,oBAAoB,EAAEA;EACxB,CAAC,CAAC;;EAEF;;EAEAsF,IAAI,CAACvG,SAAS,GAAG,CAAC,CAAC,EAAE5F,WAAW,CAAC,SAAS,CAAC,EAAE4F,SAAS,EAAE,CAACkG,4BAA4B,IAAIC,0BAA0B,IAAIG,OAAO,GAAG9L,eAAe,CAAC,SAAS,CAAC,CAACwM,eAAe,GAAG,IAAI,EAAEd,4BAA4B,IAAI,CAACC,0BAA0B,IAAIG,OAAO,GAAG9L,eAAe,CAAC,SAAS,CAAC,CAACyM,iBAAiB,GAAG,IAAI,CAAC;EACjT,OAAO;IACLC,oBAAoB,EAAE;MACpBd,QAAQ,EAAEA,QAAQ;MAClBC,QAAQ,EAAEA,QAAQ;MAClBG,qBAAqB,EAAEA,qBAAqB;MAC5CxI,kBAAkB,EAAEA,kBAAkB;MACtC4C,gBAAgB,EAAEA;IACpB,CAAC;IACDkG,kBAAkB,EAAEA,kBAAkB;IACtCK,uBAAuB,EAAEzL,aAAa,CAAC,CAAC,CAAC,EAAE6K,IAAI;EACjD,CAAC;AACH,CAAC;AACD,IAAIa,QAAQ,GAAG5N,OAAO,CAAC,SAAS,CAAC,GAAGE,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}